# Vim快捷键

### 强制写入文件内容

:w !sudo tee %，然后输入密码，确定以后就会写入，按q!退出

### 进入编辑模式：i

- i表示insert：在当前光标位置的字符前插入；
- a表示append：在当前光标位置的字符后插入;
- o表示open a line below：在当前光标位置的下一行插入；
- A表示append after line：光标移动到当前行的末尾，插入；
- I表示insert before line：光标移动到当前行的开头，插入；
- O表示open a line above：光标移动到当前行的上一行，插入；
- 使用Esc回到Normal模式，使用:q保存退出
- :vs（vertical split）：竖分屏；:sp（split）横分屏；使用:q来退出分屏
- :res +/- 数字：上下调整页面大小
- :vertical resize +/- 数字：左右调整页面大小
- :set nu：设置行号；
- 进入可视化（Visual）模式：一般用来进行块状选择：
  - Normal模式下使用v进入visual选择；
  - 使用V选择行；
  - 使用ctrl + v进行方块选择；
  - Visual模式下：
    - 选中后按d是删除；
    - 按y是复制；
    - 按p是粘贴；
- :e!：重新加载当前文件，不保存;
- :q!：放弃保存直接退出；
- :qa：退出所有窗口；
- 修改vim配置文件后不用退出直接生效：:source +配置文件的路径



### 快速纠错：

- ctrl + h：删除上一个字符；
- ctrl + w：删除上一个单词；
- ctrl + u：删除当前行；
- 以上操作也使用于终端下使用，除此之外，终端下还有：
  - ctrl + a：快速移动到命令开头
  - ctrl + e：快速移动到命令结尾
  - ctrl + b：前移光标
  - ctrl + f：后移光标



### 常用操作：

- insert模式切换到normal模式：
  - ESC，或ctrl + c（可能会中断某些程序），或ctrl + [
  - 使用gi快速回到上次编辑的地方，继续插入模式；
  
- normal模式下快速移动：
  - w/W移动到下一个word/WORD开头；e/E移动到下一个word/WORD结尾；
  - b/B移动到上一个word/WORD开头；
  - word指的是以非空白符分割的单词，WORD指的是以空白符分割的单词；
  
- normal模式下的快速CRUD：

  - normal模式下使用x快速删除一个字符；
  - 使用d(delete)配合文本对象快速删除一个单词；
    - daw：删除一个单词和其周围的字符，如空格等；
    - diw：仅删除一个单词；
    - dd：删除一整行；
    - dt + 字符：删除当前位置到选定字符范围内的字符，如：dt + )：删除右括号前的内容
    - d + $：删除当前位置到行尾之间的内容；
    - d + 0：删除开头到当前位置之间的内容；
  - d和x都可以搭配数字来执行多次；
    - 比如：2dd：删除两行；4x：删除4个字符
  - u用来撤销之前的操作；
  - ctrl + r：重做撤销了的操作；
  - 快速修改：
    - r（replace）：normal模式下用来替换一个字符s（substitute）：删除光标位置的字符并进入插入模式；
    - c（change）：配合文本对象，进行快速修改；
    - R：从光标位置开始进行替换；
    - S：删除一行并进入插入模式；
    - 同样也可以搭配数字来执行多次，如：4s：删除4个字符并进入插入模式；
    - ct + 字符：删除当前位置到选定字符范围内的字符，并进入插入模式；
    - cw（change word）：删除当前位置到单词末尾之间的内容，并进入插入模式；
    - C：删除整行并进入插入模式
    - ci （change in) + 字符：如：ci + "，删除引号内的所有内容
  - 快速查询：
    - 使用/或者？进行前向或者反向搜索；
    - 使用n/N跳转到下一个或者上一个匹配；
    - 使用*或者#进行当前单词的前向和后向匹配；
    - :set hls（high light set）：将搜索的结果集高亮显示；
    - :set incsearch：增量search，边搜索边高亮
  - Vim替换命令：
    - substitute命令允许查找并替换文本，支持正则表达式：
    - :[range]s[ubstitute]/{pattern}/{string}/[flags]
      - range表示范围：如：10,20表示10-20行，%表示全部
      - pattern：模式
      - string：替换后的文本
      - flags：替换标志位，常用标志位有：
        - g（global）：全局范围内执行；
        - c（confirm）：表示确认，可以确认或者拒绝修改；
        - n（number）：报告匹配到的次数而不替换，可以用来查询匹配次数；
          - 如：:% s/this//n：返回全局内匹配到this的次数；
        - 如：:% s/文本A/文本B/g
      - 使用正则：`:%  s/\<quack\>/jiao/g`：精确匹配quack单词，并替换，类似do_quack这样的不会被替换

- 行间搜索移动：同一行快速移动的方式其实是搜索一个字符并且移动到该字符：
  - f{char}可以移动到char字符上，t移动到char的前一个字符；
  - 如果第一次没搜到，可以用分号（;）/逗号（,）继续搜索该行下一个/上一个;
  - 大写的F表示反过来搜前面的字符；
  
- Vim水平移动：
  - 0移动到行首第一个字符，^移动到第一个非空白字符；
  - $移动到行尾，g_移动到行尾非空白字符；
  - 常用组合：0w移动到第一个非空白字符；
  
- Vim页面移动：
  - gg/G移动到文件开头和结尾；
  - 可以使用ctrl + o 和 ctrl + i来快速返回；
  - H/M/L跳转到屏幕的开头（head），中间（middle）和结尾（lower）；
  - ctrl + u：上翻页；ctrl + f：下翻页；
  - zz把屏幕置为中间；
  - zt把当前行放到屏幕最上面
  - 光标放到文件路径上，按gf可以直接打开文件，然后使用ctrl + o 或 ctrl + i 来移动返回
  
- 可视模式：

  - ctrl + v：进入可视块模式
    - 在可视块模式中选中多行，按i进入插入模式，插入完成后退出插入，则可以在多行中插入相同的内容

  

### Vim多文件操作：

- 相关概念：
  - Buffer：打开的一个文件的内存缓冲区；
  - 窗口：是Buffer可视化的分割区域；
  - Tab：可以组织窗口为一个工作区；
- Buffer：
  - Vim打开一个文件后会加载文件内容到缓冲区，之后的所有操作都是针对内存中的缓冲区，不会直接保存到文件，直到执行w操作后才会写入内存；
  - Buffer 间的切换：
    - :ls：列举当前缓冲区，然后使用 :b n 跳转到第n个缓冲区；
    - :bpre :bnext :bfirst :blast ：跳转到前一个、下一个、第一个、最后一个缓冲区；
    - :b buffer_name 结合tab补全来进行跳转
- 打开多个文件的方法：同一路径下，使用 :e + 文件名打开，打开后只有一个窗口显示，可以使用:ls查看当前存在的缓冲区
- 窗口：
  - 一个缓冲区可以分割成多个窗口，每个窗口也可以打开不同缓冲区；
  - <Ctrl + w>s 水平分割；<Ctrl + w>v垂直分割；或者:sp和:sv；
  - <Ctrl + w>w/h/j/k/l：窗口间循环切换/切到左、下、上、右的窗口
  - <Ctrl + w>L / <Ctrl + w>H：交换左右窗口的位置；
- ctrl + w + p：回到上一个窗口



### 文本对象操作方式

- [number]<command>[text object]
  - number表示次数；
  - command是命令：d（删除），c（修改），y（复制），v（选择模式）
  - text object 是要操作的文本对象，比如单词w，句子s，d段落p
- 快速选中双引号内的内容：vi + "
- 快速删除双引号内的内容：ci （change inner） + "
- 选中文本，U：将小写转为大写，u：将大写转为小写



### 复制粘贴

- Normal模式下：
  - y(yangk)和p(put)分别表示复制和粘贴，剪切粘贴用d和p；
  - yiw复制一个单词，yy复制一行
- 使用多组寄存器进行复制粘贴：
  - 通过 `"{register}` 前缀可以制定寄存器，不指定默认使用无名寄存器；
  - 如：使用"ayy复制行到寄存器a中，使用"bdd删除当前行到b寄存器中，然后在新的位置使用"ap粘贴寄存器a中的内容，在其他位置使用"bp粘贴寄存器b中的内容
  - 使用`:reg {register}` 来查看某个寄存器中存储的内容
- 复制到系统剪贴板，实现复制的内容可以粘贴到vim以外的地方：
  - 使用:echo has('clipboard')检查vim是否支持剪贴板，需要返回1；
  - "+ 表示复制到系统剪贴板
  - 也可以：:set clipboard=unnamed，然后直接复制粘贴系统剪贴板的内容
  - 在插入模式下使用 `ctrl + r + 加号` 可以将系统剪贴板的内容进行粘贴



### 宏（macro)

- 宏可以看成是一系列命令的集合；
- 可以使用宏录制一系列操作，然后用于回放；
- 可以非常方便地把一系列命令用在多行文本上；
- 使用：
  - 在normal模式下使用q来进行录制，同时也是使用q来结束录制；
  - 使用q{register}选择要保持的寄存器，把录制的命令保存其中；
  - 使用@{register}回放寄存器中保存的一系列命令；
  - 批量执行宏：
    - 在v模式下选中需要执行宏的文本对象；
    - 使用：:normal @{register}；
    - 可以使用的快捷键：
      - V进入浏览模式并选中当前行；
      - 浏览模式下使用G移动到文件末尾；
  - 不使用宏的方式实现：
    - 在v模式下选中需要执行的文本对象;
    - 使用命令行：:normal 命令 即可实现批量执行;
      - 如：`:normal A "` 即可在选中的行前加上“



### vim中的命令行操作

- ctrl + p 可以重新显示上次执行的命令
- :source ~/.config/nvim/init.vim 直接让nvim配置生效
- :e 文件路径：打开文件



### 常用的代码补全

- 使用ctrl + n 和 ctrl + p补全单词；
- 使用ctrl + x 和 ctrl + f 补全文件名；
- 插入当前文件名：:r! echo %；
- 插入当前完整路径：:r! echo %:p；



### 映射

- noremap：非递归映射
- 对应到三个模式下的映射：nnoremap/vnoremap/inoremap



### 插件的安装

- 在配置文件里添加 Plug '插件名'；
- 保存，调用:source方法加载；
- 调用 :PlugInstall完成安装
- 插件查找：https://vimawesome.com/



### 终端环境下的快捷键：

- ctrl + a：移动到行首；
- ctrl + e：移动到行末；
- ctrl + b：字符左移；
- ctrl + f：字符右移；
- 快速纠错中的快捷键也适用



### vim-surround

- ds(delete a surrounding)
  - ds "：删除双引号
- cs(change a surrounding)
  - cs " '：把双引号变成单引号
- ys(you add a surrounding)
  - ys iw "：给光标所在位置的单词加上双引号



### Tmux

- ctrl + b + %：将一个窗口分成左右部分
- ctrl + b + " ：将一个窗口分成上下两部分

- ctrl + b + o ：在pane 之间切换
- ctrl + b + c：创建一个新的窗口
- ctrl + b + n/p ：在窗口之间切换
- ctrl + b + s：查看现有会话
- ctrl + b + d：脱离会话
- 在终端下：
  - tmux ls：显示所有会话
  - tmux new -s name：新建会话
  - tmux att -t name：重新连接到会话



### Golang Debug —— delve

- dlv main.go 开始进入调试
- b：打断点
- c：开始执行/继续运行
- n：下一步
- s：进入函数
- step out：退出函数



### UltiSnips

- 在vim文件中使用：`:UltiSnipsEdit` 进入编辑

